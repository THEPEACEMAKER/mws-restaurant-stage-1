"use strict";function openDatabase(){return navigator.serviceWorker?idb.open("restaurantsDB",1,function(e){e.createObjectStore("restaurantsOS",{keyPath:"id"})}):Promise.resolve()}function addRestaurantsToCache(e){openDatabase().then(function(t){if(t){var n=t.transaction("restaurantsOS","readwrite"),r=n.objectStore("restaurantsOS");return null==e.length?r.put(e):e.forEach(function(e){r.put(e)}),n.complete}}).then(function(){})}function showCachedRestaurants(){return openDatabase().then(function(e){return e.transaction("restaurantsOS").objectStore("restaurantsOS").getAll()}).then(function(e){return e})}function showCachedRestaurant(e){return openDatabase().then(function(t){var n=t.transaction("restaurantsOS").objectStore("restaurantsOS");return e=parseInt(e),n.get(e)}).then(function(e){return e})}!function(){function e(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function t(t,n,r){var o,a=new Promise(function(a,u){e(o=t[n].apply(t,r)).then(a,u)});return a.request=o,a}function n(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function r(e,n,r,o){o.forEach(function(o){o in r.prototype&&(e.prototype[o]=function(){return t(this[n],o,arguments)})})}function o(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function a(e,n,r,o){o.forEach(function(o){o in r.prototype&&(e.prototype[o]=function(){return e=this[n],(r=t(e,o,arguments)).then(function(e){if(e)return new i(e,r.request)});var e,r})})}function u(e){this._index=e}function i(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function c(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function l(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new c(n)}function f(e){this._db=e}n(u,"_index",["name","keyPath","multiEntry","unique"]),r(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),n(i,"_cursor",["direction","key","primaryKey","value"]),r(i,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(i.prototype[t]=function(){var n=this,r=arguments;return Promise.resolve().then(function(){return n._cursor[t].apply(n._cursor,r),e(n._request).then(function(e){if(e)return new i(e,n._request)})})})}),s.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},n(s,"_store",["name","keyPath","indexNames","autoIncrement"]),r(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),a(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(s,"_store",IDBObjectStore,["deleteIndex"]),c.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},n(c,"_tx",["objectStoreNames","mode"]),o(c,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},n(l,"_db",["name","version","objectStoreNames"]),o(l,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new c(this._db.transaction.apply(this._db,arguments))},n(f,"_db",["name","version","objectStoreNames"]),o(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[s,u].forEach(function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),r=n[n.length-1],o=this._store||this._index,a=o[e].apply(o,n.slice(0,-1));a.onsuccess=function(){r(a.result)}})})}),[u,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(o){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():o(r)):o(r)})})})});var h={open:function(e,n,r){var o=t(indexedDB,"open",[e,n]),a=o.request;return a&&(a.onupgradeneeded=function(e){r&&r(new l(a.result,e.oldVersion,a.transaction))}),o.then(function(e){return new f(e)})},delete:function(e){return t(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=h,module.exports.default=module.exports):self.idb=h}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var map,DBHelper=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"fetchRestaurants",value:function(t){showCachedRestaurants().then(function(n){0!=n.length?t(null,n):fetch(e.DATABASE_URL).then(function(e){return e.json()}).then(function(e){t(null,e),addRestaurantsToCache(e)}).catch(function(e){console.log(e),t(e,null)})}).catch(function(n){console.log(n),fetch(e.DATABASE_URL).then(function(e){return e.json()}).then(function(e){t(null,e),addRestaurantsToCache(e)}).catch(function(e){console.log(e),t(e,null)})})}},{key:"fetchRestaurantById",value:function(t,n){showCachedRestaurant(t).then(function(r){null!=r?n(null,r):fetch(e.DATABASE_URL+"/"+t).then(function(e){return e.json()}).then(function(e){n(null,e),addRestaurantsToCache(e)}).catch(function(e){console.log(e),n(e,null)})}).catch(function(r){console.log(r),fetch(e.DATABASE_URL+"/"+t).then(function(e){return e.json()}).then(function(e){n(null,e),addRestaurantsToCache(e)}).catch(function(e){console.log(e),n(e,null)})})}},{key:"fetchRestaurantByCuisine",value:function(t,n){e.fetchRestaurants(function(e,r){if(e)n(e,null);else{var o=r.filter(function(e){return e.cuisine_type==t});n(null,o)}})}},{key:"fetchRestaurantByNeighborhood",value:function(t,n){e.fetchRestaurants(function(e,r){if(e)n(e,null);else{var o=r.filter(function(e){return e.neighborhood==t});n(null,o)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(t,n,r){e.fetchRestaurants(function(e,o){if(e)r(e,null);else{var a=o;"all"!=t&&(a=a.filter(function(e){return e.cuisine_type==t})),"all"!=n&&(a=a.filter(function(e){return e.neighborhood==n})),r(null,a)}})}},{key:"fetchNeighborhoods",value:function(t){e.fetchRestaurants(function(e,n){if(e)t(e,null);else{var r=n.map(function(e,t){return n[t].neighborhood}),o=r.filter(function(e,t){return r.indexOf(e)==t});t(null,o)}})}},{key:"fetchCuisines",value:function(t){e.fetchRestaurants(function(e,n){if(e)t(e,null);else{var r=n.map(function(e,t){return n[t].cuisine_type}),o=r.filter(function(e,t){return r.indexOf(e)==t});t(null,o)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return"/img/"+e.photograph}},{key:"mapMarkerForRestaurant",value:function(t,n){return new google.maps.Marker({position:t.latlng,title:t.name,url:e.urlForRestaurant(t),map:n,animation:google.maps.Animation.DROP})}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/restaurants"}}]),e}(),restaurants=void 0,neighborhoods=void 0,cuisines=void 0,markers=[];document.addEventListener("DOMContentLoaded",function(e){fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,t=document.getElementById("neighborhoods-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.cuisines,t=document.getElementById("cuisines-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,o=e[n].value,a=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(o,a,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())});var u=t.querySelector("option[aria-selected='true']");u&&u.removeAttribute("aria-selected");var i=e.querySelector("option[aria-selected='true']");i&&i.removeAttribute("aria-selected"),t[r].setAttribute("aria-selected","true"),e[n].setAttribute("aria-selected","true")},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),n=document.createElement("div");n.className="restaurant-item",t.append(n);var r=document.createElement("img");r.className="restaurant-img",r.setAttribute("alt",e.name+" restaurant image"),r.src="/img/"+e.id+"-300w.jpg",r.setAttribute("srcset","/img/"+e.id+"-300w.jpg 300w, /img/"+e.id+"-400w.jpg 400w"),r.setAttribute("sizes","(max-width: 450px) 300px, (max-width: 650px) 400px, (max-width: 875px) 300px, (max-width: 1000px) 400px, 300px"),n.append(r);var o=document.createElement("h3");o.innerHTML=e.name,n.append(o);var a=document.createElement("p");a.innerHTML=e.neighborhood,n.append(a);var u=document.createElement("p");u.innerHTML=e.address,n.append(u);var i=document.createElement("a");return i.innerHTML="View Details",i.href=DBHelper.urlForRestaurant(e),n.append(i),t},addMarkersToMap=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlkYi1saWJyYXJ5LmpzIiwiaWRiLXNjcmlwdC5qcyIsIm1haW4uanMiLCJkYmhlbHBlci5qcyJdLCJuYW1lcyI6WyJvcGVuRGF0YWJhc2UiLCJuYXZpZ2F0b3IiLCJzZXJ2aWNlV29ya2VyIiwiaWRiIiwib3BlbiIsInVwZ3JhZGVEYiIsImNyZWF0ZU9iamVjdFN0b3JlIiwia2V5UGF0aCIsIlByb21pc2UiLCJyZXNvbHZlIiwiYWRkUmVzdGF1cmFudHNUb0NhY2hlIiwicmVzdGF1cmFudHMiLCJ0aGVuIiwiZGIiLCJ0eCIsInRyYW5zYWN0aW9uIiwic3RvcmUiLCJvYmplY3RTdG9yZSIsInVuZGVmaW5lZCIsImxlbmd0aCIsInB1dCIsImZvckVhY2giLCJyZXN0YXVyYW50IiwiY29tcGxldGUiLCJzaG93Q2FjaGVkUmVzdGF1cmFudHMiLCJnZXRBbGwiLCJzaG93Q2FjaGVkUmVzdGF1cmFudCIsImlkIiwiU3RvcmUiLCJwYXJzZUludCIsImdldCIsInByb21pc2lmeVJlcXVlc3QiLCJyZXF1ZXN0IiwicmVqZWN0Iiwib25zdWNjZXNzIiwicmVzdWx0Iiwib25lcnJvciIsImVycm9yIiwicHJvbWlzaWZ5UmVxdWVzdENhbGwiLCJvYmoiLCJtZXRob2QiLCJhcmdzIiwicCIsImFwcGx5IiwicHJveHlQcm9wZXJ0aWVzIiwiUHJveHlDbGFzcyIsInRhcmdldFByb3AiLCJwcm9wZXJ0aWVzIiwicHJvcCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwicHJvdG90eXBlIiwidGhpcyIsInNldCIsInZhbCIsInByb3h5UmVxdWVzdE1ldGhvZHMiLCJDb25zdHJ1Y3RvciIsImFyZ3VtZW50cyIsInByb3h5TWV0aG9kcyIsInByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMiLCJ2YWx1ZSIsIkN1cnNvciIsIkluZGV4IiwiaW5kZXgiLCJfaW5kZXgiLCJjdXJzb3IiLCJfY3Vyc29yIiwiX3JlcXVlc3QiLCJPYmplY3RTdG9yZSIsIl9zdG9yZSIsIlRyYW5zYWN0aW9uIiwiaWRiVHJhbnNhY3Rpb24iLCJfdHgiLCJvbmNvbXBsZXRlIiwib25hYm9ydCIsIlVwZ3JhZGVEQiIsIm9sZFZlcnNpb24iLCJfZGIiLCJEQiIsIklEQkluZGV4IiwiSURCQ3Vyc29yIiwibWV0aG9kTmFtZSIsImNyZWF0ZUluZGV4IiwiSURCT2JqZWN0U3RvcmUiLCJJREJUcmFuc2FjdGlvbiIsIklEQkRhdGFiYXNlIiwiZnVuY05hbWUiLCJyZXBsYWNlIiwiYXJyIiwiQXJyYXkiLCJzbGljZSIsImNhbGwiLCJjYWxsYmFjayIsIm5hdGl2ZU9iamVjdCIsInF1ZXJ5IiwiY291bnQiLCJpbnN0YW5jZSIsIml0ZW1zIiwiaXRlcmF0ZUN1cnNvciIsInB1c2giLCJjb250aW51ZSIsImV4cCIsIm5hbWUiLCJ2ZXJzaW9uIiwidXBncmFkZUNhbGxiYWNrIiwiaW5kZXhlZERCIiwib251cGdyYWRlbmVlZGVkIiwiZXZlbnQiLCJkZWxldGUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZGVmYXVsdCIsInNlbGYiLCJtYXAiLCJEQkhlbHBlciIsImZldGNoIiwiREFUQUJBU0VfVVJMIiwicmVzcG9uc2UiLCJqc29uIiwiY2F0Y2giLCJlIiwiY29uc29sZSIsImxvZyIsImN1aXNpbmUiLCJmZXRjaFJlc3RhdXJhbnRzIiwicmVzdWx0cyIsImZpbHRlciIsInIiLCJjdWlzaW5lX3R5cGUiLCJuZWlnaGJvcmhvb2QiLCJuZWlnaGJvcmhvb2RzIiwidiIsImkiLCJ1bmlxdWVOZWlnaGJvcmhvb2RzIiwiaW5kZXhPZiIsImN1aXNpbmVzIiwidW5pcXVlQ3Vpc2luZXMiLCJwaG90b2dyYXBoIiwiZ29vZ2xlIiwibWFwcyIsIk1hcmtlciIsInBvc2l0aW9uIiwibGF0bG5nIiwidGl0bGUiLCJ1cmwiLCJ1cmxGb3JSZXN0YXVyYW50IiwiYW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiRFJPUCIsIm1hcmtlcnMiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJmZXRjaEN1aXNpbmVzIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJvcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsIndpbmRvdyIsImluaXRNYXAiLCJNYXAiLCJ6b29tIiwiY2VudGVyIiwibGF0IiwibG5nIiwic2Nyb2xsd2hlZWwiLCJ1cGRhdGVSZXN0YXVyYW50cyIsImNTZWxlY3QiLCJuU2VsZWN0IiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc2V0UmVzdGF1cmFudHMiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwibkxhc3RTZWxlY3RlZCIsInF1ZXJ5U2VsZWN0b3IiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjTGFzdFNlbGVjdGVkIiwic2V0QXR0cmlidXRlIiwibSIsInNldE1hcCIsInVsIiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJhZGRNYXJrZXJzVG9NYXAiLCJsaSIsInJlc3RhdXJhbnRJdGVtIiwiY2xhc3NOYW1lIiwiaW1hZ2UiLCJzcmMiLCJhZGRyZXNzIiwibW9yZSIsImhyZWYiLCJtYXJrZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwiYWRkTGlzdGVuZXIiLCJsb2NhdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUEsYUNHQSxTQUFTQSxlQUdQLE9BQUtDLFVBQVVDLGNBSVJDLElBQUlDLEtBQUssZ0JBQWlCLEVBQUcsU0FBU0MsR0FDL0JBLEVBQVVDLGtCQUFrQixnQkFBaUIsQ0FBRUMsUUFBUyxTQUo3REMsUUFBUUMsVUFTbkIsU0FBU0Msc0JBQXNCQyxHQUM3QlgsZUFBZVksS0FBSyxTQUFTQyxHQUMzQixHQUFLQSxFQUFMLENBRUEsSUFBSUMsRUFBS0QsRUFBR0UsWUFBWSxnQkFBaUIsYUFDckNDLEVBQVFGLEVBQUdHLFlBQVksaUJBVTNCLE9BUnlCQyxNQUF0QlAsRUFBWVEsT0FDZEgsRUFB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QWlCM0gsR0FDdEN3SyxFQUFlOUIsT0FBT21DLEdBRWZOLEdBS1RELGdCQUFrQixZQUFvQ25JLFVBQUF0QyxPQUFBLFFBQUFELElBQUF1QyxVQUFBLEdBQUFBLFVBQUEsR0FBckJ1RCxLQUFLckcsYUFDeEJVLFFBQVEsU0FBQUMsR0FFbEIsSUFBTStLLEVBQVNuRixTQUFTb0YsdUJBQXVCaEwsRUFBWTBGLEtBQUtDLEtBQ2hFeUIsT0FBT0MsS0FBS2hDLE1BQU00RixZQUFZRixFQUFRLFFBQVMsV0FDN0NuQyxPQUFPc0MsU0FBU0osS0FBT0MsRUFBT3JELE1BRWhDaEMsS0FBS3FDLFFBQVFsRCxLQUFLa0ciLCJmaWxlIjoibWFpbnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgZnVuY3Rpb24gdG9BcnJheShhcnIpIHtcclxuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3VsdCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XHJcbiAgICB2YXIgcmVxdWVzdDtcclxuICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgIHJlcXVlc3QgPSBvYmpbbWV0aG9kXS5hcHBseShvYmosIGFyZ3MpO1xyXG4gICAgICBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHAucmVxdWVzdCA9IHJlcXVlc3Q7XHJcbiAgICByZXR1cm4gcDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XHJcbiAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKTtcclxuICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xyXG4gICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgcC5yZXF1ZXN0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcHJveHlQcm9wZXJ0aWVzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIHByb3BlcnRpZXMpIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eUNsYXNzLnByb3RvdHlwZSwgcHJvcCwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICB0aGlzW3RhcmdldFByb3BdW3Byb3BdID0gdmFsO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb3h5UmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xyXG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xyXG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdLmFwcGx5KHRoaXNbdGFyZ2V0UHJvcF0sIGFyZ3VtZW50cyk7XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcclxuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xyXG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBJbmRleChpbmRleCkge1xyXG4gICAgdGhpcy5faW5kZXggPSBpbmRleDtcclxuICB9XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhJbmRleCwgJ19pbmRleCcsIFtcclxuICAgICduYW1lJyxcclxuICAgICdrZXlQYXRoJyxcclxuICAgICdtdWx0aUVudHJ5JyxcclxuICAgICd1bmlxdWUnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xyXG4gICAgJ2dldCcsXHJcbiAgICAnZ2V0S2V5JyxcclxuICAgICdnZXRBbGwnLFxyXG4gICAgJ2dldEFsbEtleXMnLFxyXG4gICAgJ2NvdW50J1xyXG4gIF0pO1xyXG5cclxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcclxuICAgICdvcGVuQ3Vyc29yJyxcclxuICAgICdvcGVuS2V5Q3Vyc29yJ1xyXG4gIF0pO1xyXG5cclxuICBmdW5jdGlvbiBDdXJzb3IoY3Vyc29yLCByZXF1ZXN0KSB7XHJcbiAgICB0aGlzLl9jdXJzb3IgPSBjdXJzb3I7XHJcbiAgICB0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcclxuICB9XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhDdXJzb3IsICdfY3Vyc29yJywgW1xyXG4gICAgJ2RpcmVjdGlvbicsXHJcbiAgICAna2V5JyxcclxuICAgICdwcmltYXJ5S2V5JyxcclxuICAgICd2YWx1ZSdcclxuICBdKTtcclxuXHJcbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhDdXJzb3IsICdfY3Vyc29yJywgSURCQ3Vyc29yLCBbXHJcbiAgICAndXBkYXRlJyxcclxuICAgICdkZWxldGUnXHJcbiAgXSk7XHJcblxyXG4gIC8vIHByb3h5ICduZXh0JyBtZXRob2RzXHJcbiAgWydhZHZhbmNlJywgJ2NvbnRpbnVlJywgJ2NvbnRpbnVlUHJpbWFyeUtleSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kTmFtZSkge1xyXG4gICAgaWYgKCEobWV0aG9kTmFtZSBpbiBJREJDdXJzb3IucHJvdG90eXBlKSkgcmV0dXJuO1xyXG4gICAgQ3Vyc29yLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgY3Vyc29yID0gdGhpcztcclxuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGN1cnNvci5fY3Vyc29yW21ldGhvZE5hbWVdLmFwcGx5KGN1cnNvci5fY3Vyc29yLCBhcmdzKTtcclxuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdChjdXJzb3IuX3JlcXVlc3QpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgIGlmICghdmFsdWUpIHJldHVybjtcclxuICAgICAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBjdXJzb3IuX3JlcXVlc3QpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIE9iamVjdFN0b3JlKHN0b3JlKSB7XHJcbiAgICB0aGlzLl9zdG9yZSA9IHN0b3JlO1xyXG4gIH1cclxuXHJcbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmNyZWF0ZUluZGV4ID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmNyZWF0ZUluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcclxuICB9O1xyXG5cclxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuaW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xyXG4gIH07XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIFtcclxuICAgICduYW1lJyxcclxuICAgICdrZXlQYXRoJyxcclxuICAgICdpbmRleE5hbWVzJyxcclxuICAgICdhdXRvSW5jcmVtZW50J1xyXG4gIF0pO1xyXG5cclxuICBwcm94eVJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcclxuICAgICdwdXQnLFxyXG4gICAgJ2FkZCcsXHJcbiAgICAnZGVsZXRlJyxcclxuICAgICdjbGVhcicsXHJcbiAgICAnZ2V0JyxcclxuICAgICdnZXRBbGwnLFxyXG4gICAgJ2dldEtleScsXHJcbiAgICAnZ2V0QWxsS2V5cycsXHJcbiAgICAnY291bnQnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xyXG4gICAgJ29wZW5DdXJzb3InLFxyXG4gICAgJ29wZW5LZXlDdXJzb3InXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXHJcbiAgICAnZGVsZXRlSW5kZXgnXHJcbiAgXSk7XHJcblxyXG4gIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKGlkYlRyYW5zYWN0aW9uKSB7XHJcbiAgICB0aGlzLl90eCA9IGlkYlRyYW5zYWN0aW9uO1xyXG4gICAgdGhpcy5jb21wbGV0ZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICB9O1xyXG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcclxuICAgICAgfTtcclxuICAgICAgaWRiVHJhbnNhY3Rpb24ub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl90eC5vYmplY3RTdG9yZS5hcHBseSh0aGlzLl90eCwgYXJndW1lbnRzKSk7XHJcbiAgfTtcclxuXHJcbiAgcHJveHlQcm9wZXJ0aWVzKFRyYW5zYWN0aW9uLCAnX3R4JywgW1xyXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnLFxyXG4gICAgJ21vZGUnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5TWV0aG9kcyhUcmFuc2FjdGlvbiwgJ190eCcsIElEQlRyYW5zYWN0aW9uLCBbXHJcbiAgICAnYWJvcnQnXHJcbiAgXSk7XHJcblxyXG4gIGZ1bmN0aW9uIFVwZ3JhZGVEQihkYiwgb2xkVmVyc2lvbiwgdHJhbnNhY3Rpb24pIHtcclxuICAgIHRoaXMuX2RiID0gZGI7XHJcbiAgICB0aGlzLm9sZFZlcnNpb24gPSBvbGRWZXJzaW9uO1xyXG4gICAgdGhpcy50cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XHJcbiAgfVxyXG5cclxuICBVcGdyYWRlREIucHJvdG90eXBlLmNyZWF0ZU9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX2RiLmNyZWF0ZU9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcclxuICB9O1xyXG5cclxuICBwcm94eVByb3BlcnRpZXMoVXBncmFkZURCLCAnX2RiJywgW1xyXG4gICAgJ25hbWUnLFxyXG4gICAgJ3ZlcnNpb24nLFxyXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXHJcbiAgXSk7XHJcblxyXG4gIHByb3h5TWV0aG9kcyhVcGdyYWRlREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xyXG4gICAgJ2RlbGV0ZU9iamVjdFN0b3JlJyxcclxuICAgICdjbG9zZSdcclxuICBdKTtcclxuXHJcbiAgZnVuY3Rpb24gREIoZGIpIHtcclxuICAgIHRoaXMuX2RiID0gZGI7XHJcbiAgfVxyXG5cclxuICBEQi5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5fZGIudHJhbnNhY3Rpb24uYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xyXG4gIH07XHJcblxyXG4gIHByb3h5UHJvcGVydGllcyhEQiwgJ19kYicsIFtcclxuICAgICduYW1lJyxcclxuICAgICd2ZXJzaW9uJyxcclxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xyXG4gIF0pO1xyXG5cclxuICBwcm94eU1ldGhvZHMoREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xyXG4gICAgJ2Nsb3NlJ1xyXG4gIF0pO1xyXG5cclxuICAvLyBBZGQgY3Vyc29yIGl0ZXJhdG9yc1xyXG4gIC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uY2UgYnJvd3NlcnMgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGggcHJvbWlzZXNcclxuICBbJ29wZW5DdXJzb3InLCAnb3BlbktleUN1cnNvciddLmZvckVhY2goZnVuY3Rpb24oZnVuY05hbWUpIHtcclxuICAgIFtPYmplY3RTdG9yZSwgSW5kZXhdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcclxuICAgICAgLy8gRG9uJ3QgY3JlYXRlIGl0ZXJhdGVLZXlDdXJzb3IgaWYgb3BlbktleUN1cnNvciBkb2Vzbid0IGV4aXN0LlxyXG4gICAgICBpZiAoIShmdW5jTmFtZSBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XHJcblxyXG4gICAgICBDb25zdHJ1Y3Rvci5wcm90b3R5cGVbZnVuY05hbWUucmVwbGFjZSgnb3BlbicsICdpdGVyYXRlJyldID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XHJcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJnc1thcmdzLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgIHZhciBuYXRpdmVPYmplY3QgPSB0aGlzLl9zdG9yZSB8fCB0aGlzLl9pbmRleDtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IG5hdGl2ZU9iamVjdFtmdW5jTmFtZV0uYXBwbHkobmF0aXZlT2JqZWN0LCBhcmdzLnNsaWNlKDAsIC0xKSk7XHJcbiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGNhbGxiYWNrKHJlcXVlc3QucmVzdWx0KTtcclxuICAgICAgICB9O1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIHBvbHlmaWxsIGdldEFsbFxyXG4gIFtJbmRleCwgT2JqZWN0U3RvcmVdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcclxuICAgIGlmIChDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsKSByZXR1cm47XHJcbiAgICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsID0gZnVuY3Rpb24ocXVlcnksIGNvdW50KSB7XHJcbiAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgIHZhciBpdGVtcyA9IFtdO1xyXG5cclxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcclxuICAgICAgICBpbnN0YW5jZS5pdGVyYXRlQ3Vyc29yKHF1ZXJ5LCBmdW5jdGlvbihjdXJzb3IpIHtcclxuICAgICAgICAgIGlmICghY3Vyc29yKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgaWYgKGNvdW50ICE9PSB1bmRlZmluZWQgJiYgaXRlbXMubGVuZ3RoID09IGNvdW50KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxuICB2YXIgZXhwID0ge1xyXG4gICAgb3BlbjogZnVuY3Rpb24obmFtZSwgdmVyc2lvbiwgdXBncmFkZUNhbGxiYWNrKSB7XHJcbiAgICAgIHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnb3BlbicsIFtuYW1lLCB2ZXJzaW9uXSk7XHJcbiAgICAgIHZhciByZXF1ZXN0ID0gcC5yZXF1ZXN0O1xyXG5cclxuICAgICAgaWYgKHJlcXVlc3QpIHtcclxuICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICBpZiAodXBncmFkZUNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHVwZ3JhZGVDYWxsYmFjayhuZXcgVXBncmFkZURCKHJlcXVlc3QucmVzdWx0LCBldmVudC5vbGRWZXJzaW9uLCByZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbihkYikge1xyXG4gICAgICAgIHJldHVybiBuZXcgREIoZGIpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBkZWxldGU6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ2RlbGV0ZURhdGFiYXNlJywgW25hbWVdKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgIG1vZHVsZS5leHBvcnRzID0gZXhwO1xyXG4gICAgbW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IG1vZHVsZS5leHBvcnRzO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIHNlbGYuaWRiID0gZXhwO1xyXG4gIH1cclxufSgpKTtcclxuLy8gaW1wb3J0IGlkYiBmcm9tICdpZGInO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vIHZhciBkYlByb21pc2UgPSBpZGIub3BlbigndGVzdC1kYicsIDEsIGZ1bmN0aW9uKHVwZ3JhZGVEYikge1xyXG4vLyAgIHZhciBrZXlWYWxTdG9yZSA9IHVwZ3JhZGVEYi5jcmVhdGVPYmplY3RTdG9yZSgna2V5dmFsJyk7XHJcbi8vICAga2V5VmFsU3RvcmUucHV0KFwid29ybGRcIiwgXCJoZWxsb1wiKTtcclxuLy8gfSk7IiwiXHJcbi8vIC0tLS0tSW5kZXhlZERCXHJcblxyXG5mdW5jdGlvbiBvcGVuRGF0YWJhc2UoKSB7XHJcbiAgLy8gSWYgdGhlIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IHNlcnZpY2Ugd29ya2VyLFxyXG4gIC8vIHdlIGRvbid0IGNhcmUgYWJvdXQgaGF2aW5nIGEgZGF0YWJhc2VcclxuICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gaWRiLm9wZW4oJ3Jlc3RhdXJhbnRzREInLCAxLCBmdW5jdGlvbih1cGdyYWRlRGIpIHtcclxuICAgIHZhciBzdG9yZSA9IHVwZ3JhZGVEYi5jcmVhdGVPYmplY3RTdG9yZSgncmVzdGF1cmFudHNPUycsIHsga2V5UGF0aDogJ2lkJyB9KTtcclxuICB9KTtcclxufVxyXG5cclxuLy8gb3BlbkRhdGFiYXNlKCk7XHJcbmZ1bmN0aW9uIGFkZFJlc3RhdXJhbnRzVG9DYWNoZShyZXN0YXVyYW50cykge1xyXG4gIG9wZW5EYXRhYmFzZSgpLnRoZW4oZnVuY3Rpb24oZGIpIHtcclxuICAgIGlmICghZGIpIHJldHVybjtcclxuXHJcbiAgICB2YXIgdHggPSBkYi50cmFuc2FjdGlvbigncmVzdGF1cmFudHNPUycsICdyZWFkd3JpdGUnKTtcclxuICAgIHZhciBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZXN0YXVyYW50c09TJyk7XHJcblxyXG4gICAgaWYocmVzdGF1cmFudHMubGVuZ3RoID09IHVuZGVmaW5lZCl7ICAvL2lmIHRoZSBsZW5ndGggaXMgdW5kZWZpbmVkIHRoZW4gaXQncyBvbmx5IG9uZSByZXN0YXVyYW50LCBub3QgYSBsaXN0XHJcbiAgICBcdHN0b3JlLnB1dChyZXN0YXVyYW50cyk7XHJcbiAgICB9ZWxzZXtcclxuICAgIHJlc3RhdXJhbnRzLmZvckVhY2goZnVuY3Rpb24ocmVzdGF1cmFudCkge1xyXG4gICAgICBzdG9yZS5wdXQocmVzdGF1cmFudCk7XHJcbiAgICB9KTtcclxuXHR9XHJcbiAgICBcclxuICAgIHJldHVybiB0eC5jb21wbGV0ZTtcclxuICB9KS50aGVuKGZ1bmN0aW9uKCl7XHJcbiAgXHQvLyBjb25zb2xlLmxvZygnQWRkZWQgdGhlIHJlc3RhdXJhbnRzIHRvIHRoZSBjYWNoZScpXHJcbiAgfSk7XHJcblxyXG59O1xyXG5cclxuZnVuY3Rpb24gc2hvd0NhY2hlZFJlc3RhdXJhbnRzKCkge1xyXG4gIHJldHVybiBvcGVuRGF0YWJhc2UoKS50aGVuKGZ1bmN0aW9uKGRiKSB7XHJcbiAgICB2YXIgdHggPSBkYi50cmFuc2FjdGlvbigncmVzdGF1cmFudHNPUycpO1xyXG4gICAgdmFyIFN0b3JlID0gdHgub2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzT1MnKTtcclxuXHJcbiAgICByZXR1cm4gU3RvcmUuZ2V0QWxsKCk7IC8vcmV0dXJucyBhIHByb21pc2Ugd2l0aCBhIGxpc3Qgb2YgYWxsIHRoZSBvYmplY3RzIGluIHRoZSBzdG9yZVxyXG4gIH0pLnRoZW4oZnVuY3Rpb24ocmVzdGF1cmFudHMpIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdyZXR1cm5lZCB0aGUgcmVzdGF1cmFudHMgZnJvbSB0aGUgY2FjaGUgJyArIHJlc3RhdXJhbnRzKTtcclxuICAgIHJldHVybiByZXN0YXVyYW50c1xyXG5cclxuICB9KTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIHNob3dDYWNoZWRSZXN0YXVyYW50KGlkKSB7XHJcbiAgcmV0dXJuIG9wZW5EYXRhYmFzZSgpLnRoZW4oZnVuY3Rpb24oZGIpIHtcclxuICAgIHZhciB0eCA9IGRiLnRyYW5zYWN0aW9uKCdyZXN0YXVyYW50c09TJyk7XHJcbiAgICB2YXIgU3RvcmUgPSB0eC5vYmplY3RTdG9yZSgncmVzdGF1cmFudHNPUycpO1xyXG5cclxuICAgIGlkID0gcGFyc2VJbnQoaWQpO1xyXG5cclxuICAgIHJldHVybiBTdG9yZS5nZXQoaWQpOyAvL3JldHVybnMgdGhlIHRhcmdldGVkIG9iamVjdFxyXG4gIH0pLnRoZW4oZnVuY3Rpb24ocmVzdGF1cmFudCkge1xyXG4gICAgLy8gY29uc29sZS5sb2cocmVzdGF1cmFudCk7XHJcbiAgICByZXR1cm4gcmVzdGF1cmFudDtcclxuICB9KTtcclxufTsiLCJsZXQgcmVzdGF1cmFudHMsXHJcbiAgbmVpZ2hib3Job29kcyxcclxuICBjdWlzaW5lc1xyXG52YXIgbWFwXHJcbnZhciBtYXJrZXJzID0gW11cclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBuZWlnaGJvcmhvb2RzIGFuZCBjdWlzaW5lcyBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoTmVpZ2hib3Job29kcyA9ICgpID0+IHtcclxuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcclxuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuZmlsbE5laWdoYm9yaG9vZHNIVE1MID0gKG5laWdoYm9yaG9vZHMgPSBzZWxmLm5laWdoYm9yaG9vZHMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuICBuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcclxuICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XHJcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxyXG4gKi9cclxuZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcblxyXG4gIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBjdWlzaW5lO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGxldCBsb2MgPSB7XHJcbiAgICBsYXQ6IDQwLjcyMjIxNixcclxuICAgIGxuZzogLTczLjk4NzUwMVxyXG4gIH07XHJcbiAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgem9vbTogMTIsXHJcbiAgICBjZW50ZXI6IGxvYyxcclxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gIH0pO1xyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4gKi9cclxudXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcblxyXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xyXG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbi8vIHJlbW92ZSBhcmlhLXNlbGVjdGVkIGZyb20gdGhlIExhc3RTZWxlY3RlZCBvcHRpb25cclxuICBjb25zdCBuTGFzdFNlbGVjdGVkID0gblNlbGVjdC5xdWVyeVNlbGVjdG9yKFwib3B0aW9uW2FyaWEtc2VsZWN0ZWQ9J3RydWUnXVwiKTtcclxuICBpZihuTGFzdFNlbGVjdGVkKXtcclxuICAgIG5MYXN0U2VsZWN0ZWQucmVtb3ZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJyk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBjTGFzdFNlbGVjdGVkID0gY1NlbGVjdC5xdWVyeVNlbGVjdG9yKFwib3B0aW9uW2FyaWEtc2VsZWN0ZWQ9J3RydWUnXVwiKTtcclxuICBpZihjTGFzdFNlbGVjdGVkKXtcclxuICAgIGNMYXN0U2VsZWN0ZWQucmVtb3ZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJyk7XHJcbiAgfVxyXG5cclxuLy8gYWRkIGFyaWEtc2VsZWN0ZWQgdG8gdGhlIE5ld1NlbGVjdGVkIG9wdGlvblxyXG4gIGNvbnN0IG5OZXdTZWxlY3RlZCA9IG5TZWxlY3RbbkluZGV4XTtcclxuICBuTmV3U2VsZWN0ZWQuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcclxuXHJcbiAgY29uc3QgY05ld1NlbGVjdGVkID0gY1NlbGVjdFtjSW5kZXhdO1xyXG4gIGNOZXdTZWxlY3RlZC5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xyXG4gIFxyXG5cclxuXHJcblxyXG59XHJcblxyXG4vKipcclxuICogQ2xlYXIgY3VycmVudCByZXN0YXVyYW50cywgdGhlaXIgSFRNTCBhbmQgcmVtb3ZlIHRoZWlyIG1hcCBtYXJrZXJzLlxyXG4gKi9cclxucmVzZXRSZXN0YXVyYW50cyA9IChyZXN0YXVyYW50cykgPT4ge1xyXG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gW107XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHVsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXHJcbiAgc2VsZi5tYXJrZXJzLmZvckVhY2gobSA9PiBtLnNldE1hcChudWxsKSk7XHJcbiAgc2VsZi5tYXJrZXJzID0gW107XHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICB1bC5hcHBlbmQoY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkpO1xyXG4gIH0pO1xyXG4gIGFkZE1hcmtlcnNUb01hcCgpO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cclxuICovXHJcbmNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcblxyXG4gIGNvbnN0IHJlc3RhdXJhbnRJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgcmVzdGF1cmFudEl0ZW0uY2xhc3NOYW1lID0gXCJyZXN0YXVyYW50LWl0ZW1cIjtcclxuICBsaS5hcHBlbmQocmVzdGF1cmFudEl0ZW0pO1xyXG5cclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCByZXN0YXVyYW50Lm5hbWUgKyAnIHJlc3RhdXJhbnQgaW1hZ2UnKTtcclxuICBpbWFnZS5zcmMgPSBcIi9pbWcvXCIrIHJlc3RhdXJhbnQuaWQgK1wiLTMwMHcuanBnXCI7XHJcbiAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmNzZXQnLCBcIi9pbWcvXCIrIHJlc3RhdXJhbnQuaWQgK1wiLTMwMHcuanBnIDMwMHcsIC9pbWcvXCIrIHJlc3RhdXJhbnQuaWQgK1wiLTQwMHcuanBnIDQwMHdcIik7XHJcbiAgaW1hZ2Uuc2V0QXR0cmlidXRlKCAnc2l6ZXMnLCAnKG1heC13aWR0aDogNDUwcHgpIDMwMHB4LCAobWF4LXdpZHRoOiA2NTBweCkgNDAwcHgsIChtYXgtd2lkdGg6IDg3NXB4KSAzMDBweCwgKG1heC13aWR0aDogMTAwMHB4KSA0MDBweCwgMzAwcHgnKTtcclxuICByZXN0YXVyYW50SXRlbS5hcHBlbmQoaW1hZ2UpO1xyXG5cclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICByZXN0YXVyYW50SXRlbS5hcHBlbmQobmFtZSk7XHJcblxyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBuZWlnaGJvcmhvb2QuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2Q7XHJcbiAgcmVzdGF1cmFudEl0ZW0uYXBwZW5kKG5laWdoYm9yaG9vZCk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgcmVzdGF1cmFudEl0ZW0uYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICByZXN0YXVyYW50SXRlbS5hcHBlbmQobW9yZSlcclxuXHJcbiAgcmV0dXJuIGxpXHJcbn1cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG5hZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn1cclxuIiwiLyoqXHJcbiAqIENvbW1vbiBkYXRhYmFzZSBoZWxwZXIgZnVuY3Rpb25zLlxyXG4gKi9cclxuY2xhc3MgREJIZWxwZXIge1xyXG5cclxuICAvKipcclxuICAgKiBEYXRhYmFzZSBVUkwuXHJcbiAgICogQ2hhbmdlIHRoaXMgdG8gcmVzdGF1cmFudHMuanNvbiBmaWxlIGxvY2F0aW9uIG9uIHlvdXIgc2VydmVyLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXQgREFUQUJBU0VfVVJMKCkge1xyXG4gICAgY29uc3QgcG9ydCA9IDEzMzcgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBzZXJ2ZXIgcG9ydFxyXG4gICAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH0vcmVzdGF1cmFudHNgO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIHJlc3RhdXJhbnRzLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRzKGNhbGxiYWNrKSB7XHJcbiAgICBzaG93Q2FjaGVkUmVzdGF1cmFudHMoKS50aGVuKHJlc3RhdXJhbnRzID0+e1xyXG4gICAgICBpZihyZXN0YXVyYW50cy5sZW5ndGggIT0gMCl7ICAgIC8vaWYgdGhlcmUgaXMgZGF0YSBpbiB0aGUgY2FjaGVcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50cyk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3JldHVybmVkIHRoZSByZXN0YXVyYW50cyBmcm9tIHRoZSBjYWNoZSAnICsgcmVzdGF1cmFudHMpO1xyXG4gICAgICB9ZWxzZXsgICAgLy9pZiB0aGVyZSBpcyBubyBkYXRhIGluIHRoZSBjYWNoZVxyXG4gICAgICAgIGZldGNoKERCSGVscGVyLkRBVEFCQVNFX1VSTClcclxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgICAgLnRoZW4ocmVzdGF1cmFudHMgPT57IFxyXG4gICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzdGF1cmFudHMpO1xyXG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudHMpO1xyXG4gICAgICAgICAgYWRkUmVzdGF1cmFudHNUb0NhY2hlKHJlc3RhdXJhbnRzKTtcclxuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdvbmxpbmUnKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlID0+e1xyXG4gICAgICAgICAgY29uc29sZS5sb2coZSk7XHJcbiAgICAgICAgICBjYWxsYmFjayhlLCBudWxsKTtcclxuICAgICAgICB9KTsgICAgICAgIFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGUgPT4geyAgIC8vaWYgdGhlcmUgaXMgYSBwcm9ibGVtIGluIGNoZWNraW5nIHRoZSBjYWNoZVxyXG4gICAgICBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgZmV0Y2goREJIZWxwZXIuREFUQUJBU0VfVVJMKVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgIC50aGVuKHJlc3RhdXJhbnRzID0+eyBcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXN0YXVyYW50cyk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudHMpO1xyXG4gICAgICAgIGFkZFJlc3RhdXJhbnRzVG9DYWNoZShyZXN0YXVyYW50cyk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ29ubGluZSBhbmQgYSBwcm9ibGVtIGluIHRoZSBjYWNoZScpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZSA9PntcclxuICAgICAgICBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgICBjYWxsYmFjayhlLCBudWxsKTtcclxuICAgICAgfSk7ICAgICAgICAgICAgICBcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcclxuICAgIHNob3dDYWNoZWRSZXN0YXVyYW50KGlkKS50aGVuKHJlc3RhdXJhbnQgPT57IFxyXG4gICAgICBpZihyZXN0YXVyYW50ICE9IHVuZGVmaW5lZCl7ICAvL2lmIHRoZXJlIGlzIGRhdGEgaW4gdGhlIGNhY2hlXHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3JldHVybmVkIGEgcmVzdGF1cmFudCBmcm9tIHRoZSBjYWNoZSAnICsgcmVzdGF1cmFudCk7ICAgICAgXHJcbiAgICAgIH1lbHNleyAgICAvL2lmIHRoZXJlIGlzIG5vIGRhdGEgaW4gdGhlIGNhY2hlXHJcbiAgICAgICAgZmV0Y2goREJIZWxwZXIuREFUQUJBU0VfVVJMICsgYC8ke2lkfWApXHJcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgICAgIC50aGVuKHJlc3RhdXJhbnQgPT57IFxyXG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XHJcbiAgICAgICAgICBhZGRSZXN0YXVyYW50c1RvQ2FjaGUocmVzdGF1cmFudCk7XHJcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnb25saW5lJyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZSA9PntcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGUpO1xyXG4gICAgICAgICAgY2FsbGJhY2soZSwgbnVsbCk7XHJcbiAgICAgICAgfSk7ICAgICAgICBcclxuICAgICAgfVxyXG4gICAgfSkuY2F0Y2goZSA9PnsgIC8vaWYgdGhlcmUgaXMgYSBwcm9ibGVtIGluIGNoZWNraW5nIHRoZSBjYWNoZVxyXG4gICAgICBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgZmV0Y2goREJIZWxwZXIuREFUQUJBU0VfVVJMICsgYC8ke2lkfWApXHJcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgLnRoZW4ocmVzdGF1cmFudCA9PnsgXHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XHJcbiAgICAgICAgYWRkUmVzdGF1cmFudHNUb0NhY2hlKHJlc3RhdXJhbnQpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdvbmxpbmUgYW5kIGEgcHJvYmxlbSBpbiB0aGUgY2FjaGUnKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGUgPT57XHJcbiAgICAgICAgY29uc29sZS5sb2coZSk7XHJcbiAgICAgICAgY2FsbGJhY2soZSwgbnVsbCk7XHJcbiAgICAgIH0pOyAgICAgICAgICAgICAgXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSB0eXBlIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSwgY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50cyAgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmdcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBjdWlzaW5lIHR5cGVcclxuICAgICAgICBjb25zdCByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5TmVpZ2hib3Job29kKG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIG5laWdoYm9yaG9vZFxyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSBhbmQgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdHMgPSByZXN0YXVyYW50c1xyXG4gICAgICAgIGlmIChjdWlzaW5lICE9ICdhbGwnKSB7IC8vIGZpbHRlciBieSBjdWlzaW5lXHJcbiAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG5laWdoYm9yaG9vZCAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgbmVpZ2hib3Job29kXHJcbiAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hOZWlnaGJvcmhvb2RzKGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBuZWlnaGJvcmhvb2RzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgY29uc3QgbmVpZ2hib3Job29kcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0ubmVpZ2hib3Job29kKVxyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gbmVpZ2hib3Job29kc1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZU5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzLmZpbHRlcigodiwgaSkgPT4gbmVpZ2hib3Job29kcy5pbmRleE9mKHYpID09IGkpXHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgdW5pcXVlTmVpZ2hib3Job29kcyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIGN1aXNpbmVzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IGN1aXNpbmVzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5jdWlzaW5lX3R5cGUpXHJcbiAgICAgICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBjdWlzaW5lc1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZUN1aXNpbmVzID0gY3Vpc2luZXMuZmlsdGVyKCh2LCBpKSA9PiBjdWlzaW5lcy5pbmRleE9mKHYpID09IGkpXHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgdW5pcXVlQ3Vpc2luZXMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RhdXJhbnQgcGFnZSBVUkwuXHJcbiAgICovXHJcbiAgc3RhdGljIHVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgcmV0dXJuIChgLi9yZXN0YXVyYW50Lmh0bWw/aWQ9JHtyZXN0YXVyYW50LmlkfWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzdGF1cmFudCBpbWFnZSBVUkwuXHJcbiAgICovXHJcbiAgc3RhdGljIGltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICByZXR1cm4gKGAvaW1nLyR7cmVzdGF1cmFudC5waG90b2dyYXBofWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIG1hcmtlciBmb3IgYSByZXN0YXVyYW50LlxyXG4gICAqL1xyXG4gIHN0YXRpYyBtYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1hcCkge1xyXG4gICAgY29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgIHBvc2l0aW9uOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgdGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcclxuICAgICAgdXJsOiBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpLFxyXG4gICAgICBtYXA6IG1hcCxcclxuICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUH1cclxuICAgICk7XHJcbiAgICByZXR1cm4gbWFya2VyO1xyXG4gIH1cclxuXHJcbn1cclxuIl19
